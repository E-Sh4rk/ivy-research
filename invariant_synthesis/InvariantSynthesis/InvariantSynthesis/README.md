# Invariant Synthesis Project

## Structure of the code

  - ``AST.fs``: Contains the definition of an intermediate AST that is very close to the IVy language.
  - ``ConstraintsParser.fs``: Implements a parser for environment constraints. Only used for manual mode when the environment of the counterexample must be manually specified).
  - ``Determinization.fs``: Implements a method that determinize a MinimalAST. It replaces every occurence f non-determinism by a new local variable that is added to the arguments of the main action.
  - ``Formula.fs``: Contains some utility functions among formulas. In particular, it implements the generation of an invariant from some marks (a set of marks for the counterexample and for each valid execution).
  - ``Helper.fs``: Some utility functions.
  - ``InterpretedExpr.fs``: Implements interpreted operations such as ``+``. Not used anymore since all interpreted operations disappear during the determinization of actions.
  - ``Interpreter.fs``: Evaluate an expression or execute a statement (from MinimalAST).
  - ``Marking.fs``: Compute a set of marks for a formula or a trace (from MinimalAST).
  - ``MinimalAST.fs``: Define an AST that is small and convenient for analyzes. Also implements a method that transforms an AST into a MinimalAST. In particular, all expressions are removed. Some additional statements and values (i.e. expressions without side-effects) are used instead.
  - ``Model.fs``: Contains some definitions and utility functions relative to concrete models and environments.
  - ``ParserAST.fs``: Contains a low-level AST that is similar to the AST generated by the parser. Also implements some methods to convert a low-level AST into an AST (in particular, references are resolved and types are inferred). This module is used to load an AST generated by the parser and then to convert it into a more convenient AST.
  - ``Printer.fs``: Contains some printing functions.
  - ``Program.fs``: Entry point of the project. Defines the global process for generating an invariant.
  - ``Solver.fs``: Implements some operations that are realized using the SMT-Solver Z3 (through the module Z3Utils). In particular, these operations are implemented here: search of a counterexample/valid state, symbolic bounded verification, minimization of constraints...
  - ``TestModule.fs``: Contains an hardcoded AST of a queue. Not used anymore (ASTs are now parsed from IVy code).
  - ``TInterpreted.fs``: Extension of the module Interpreter. It implements a method to execute a statement and generate a trace of this execution as output.
  - ``Trace.fs``: Contains the definition of a trace (a trace aims to describe an execution).
  - ``WPR.fs``: Implements a method that computes weakest preconditions. A new AST is used (more convenient for this operation, and more similar to the AST used by Z3 for terms and formulas).
  - ``Z3Utils.fs``: Defines some utility functions relative to the SMT-solver Z3.